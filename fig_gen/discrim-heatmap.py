import numpy as np
import os, ssl
import boto3
import csv
import networkx as nx
#from nxviz import CircosPlot
from matplotlib import pyplot as plt
from m2g.utils.cloud_utils import get_matching_s3_objects
from m2g.utils.cloud_utils import s3_client
from graspy.utils import pass_to_ranks

from math import floor
import igraph as ig
import plotly
import plotly.offline as py
from plotly.graph_objs import *


##-----------DIFFUSION DISCRIM--------------------##
func_datasets=['SWU4','HNU1','XHCUMS','BNU1','IPCAS8','NKI1','NKI24','MRN1']
dsizes=[384,298,120,114,40,36,36,20]
func_atlases=['Glasser','Schaefer1000','Schaefer300','Schaefer400','Schaefer200','AICHA','CAPRSC','Destrieux','DS00278','CPAC200','Brodmann','DKT','Talairach','Desikan','HOC','Slab907','AAL','Hammersmith','Slab1068','DS00195','DS00096','Yeo-17-lib','DS00071','MICCAI','Yeo17','DS00108','DS00140','HOS','JHU','DesikanKlein','Yeo-7-lib','Yeo-7','Juelich','Princeton','Tissue]
tot=sum(dsizes)

SWU4=[0.907092114610466,0.905470044991712,0.897720814586787,0.900556476438551,0.897347856973715,0.891771252663983,0.897762254321572,0.8804641250296,0.881091641013497,0.852030547004499,0.875017759886337,0.884164101349751,0.888367274449444,0.873697608335307,0.873460809850817,0.87183282026995,0.861715605020128,0.877912621359223,0.855653563817191,0.840516220696188,0.874295524508643,0.846400663035757,0.863112716078617,0.87700686715605,0.850153919014918,0.848218091404215,0.817315889178309,0.855659483779304,0.770139711105849,0.826906227800142,0.751435590812219,0.74920672507696,0.659489699265925,0.499905280606204,0.553856855316126]
HNU1=[0.995523627075351,0.995614303959131,0.996411238825032,0.996102171136654,0.993914431673052,0.993893997445722,0.990630906768838,0.983984674329502,0.969744572158365,0.989375478927203,0.954375478927203,0.962547892720307,0.95305619412516,0.968117496807152,0.953597701149425,0.976205619412516,0.957561941251596,0.956896551724138,0.959618135376756,0.913390804597701,0.887425287356322,0.930789272030651,0.889690932311622,0.898416347381865,0.913312899106002,0.841077905491698,0.834418901660281,0.866941251596424,0.848840357598978,0.794112388250319,0.778323116219668,0.778602809706258,0.730116219667944,0.54200319284802,0.523258620689655]
XHCUMS=[0.95966513351964,0.948125291103866,0.956581685130969,0.947755693159891,0.952778967607071,0.955390411870384,0.927180887783618,0.941147635404884,0.949879365171779,0.952053633807971,0.941882499390068,0.925547933717036,0.936609360791359,0.942155409264311,0.935805186361923,0.910805255672367,0.947710814647238,0.902217518353405,0.922655608878391,0.949094424390622,0.918276921562756,0.900791109410695,0.939178005855346,0.897388659702353,0.902486789429326,0.940486587042828,0.941678899960077,0.844218711879256,0.884656677645441,0.797431216315124,0.743511156209107,0.730182237951072,0.848504523199592,0.508666144759022,0.532980335240757]
BNU1=[0.978383458646617,0.962562656641604,0.972431077694236,0.969298245614035,0.978853383458647,0.953790726817043,0.953399122807017,0.950501253132832,0.955200501253133,0.972587719298246,0.94000626566416,0.948308270676692,0.932722431077694,0.928728070175439,0.948934837092732,0.924342105263158,0.946193609022556,0.934602130325814,0.90906954887218,0.961309523809524,0.953320802005012,0.9390664160401,0.951754385964912,0.919251253132832,0.915256892230576,0.972979323308271,0.954573934837093,0.878916040100251,0.934758771929825,0.863095238095238,0.786380012531328,0.78015350877193,0.793233082706767,0.557135025062657,0.550595238095238]
IPCAS8=[0.971153846153846,0.91025641025641,0.897435897435897,0.907051282051282,0.905448717948718,0.884615384615385,0.902243589743589,0.951923076923077,0.878205128205128,0.892628205128205,0.939102564102564,0.870192307692308,0.836538461538462,0.822115384615385,0.9375,0.86698717948718,0.842948717948718,0.857371794871795,0.831730769230769,0.911858974358974,0.884615384615385,0.916666666666667,0.866987179487179,0.782051282051282,0.846153846153846,0.884615384615385,0.921474358974359,0.778846153846154,0.780448717948718,0.671474358974359,0.746794871794872,0.698717948717949,0.623397435897436,0.455128205128205,0.560897435897436]
NKI1=[0.992763157894737,0.985526315789473,0.994078947368421,0.988157894736842,0.992763157894737,1,0.984210526315789,0.967763157894737,0.998026315789473,1,0.996710526315789,0.996710526315789,1,0.996052631578947,0.982894736842105,0.967105263157895,0.999342105263158,0.986842105263158,0.993421052631579,1,0.995394736842105,0.950657894736842,0.995394736842105,0.998026315789473,0.9375,0.998684210526316,1,0.930263157894737,0.990789473684211,0.965131578947368,0.903947368421053,0.824671052631579,0.970394736842105,0.910526315789474,0.506578947368421]
NKI24=[0.994281045751634,0.986111111111111,0.995915032679739,0.98937908496732,0.992647058823529,1,0.984477124183006,0.962418300653595,0.997549019607843,1,0.996732026143791,0.996732026143791,1,0.994281045751634,0.984477124183006,0.963235294117647,0.999183006535948,0.98202614379085,0.994281045751634,1,0.995915032679739,0.941993464052288,0.995098039215686,0.996732026143791,0.93218954248366,1,1,0.937091503267974,0.986928104575163,0.964052287581699,0.901960784313725,0.800245098039216,0.968954248366013,0.906862745098039,0.506535947712418]
MRN1=[0.908333333333333,0.925,0.875,0.883333333333333,0.833333333333333,0.891666666666667,0.858333333333333,0.9,0.783333333333333,0.866666666666667,0.991666666666667,0.833333333333333,0.816666666666667,0.883333333333333,0.833333333333333,0.975,0.825,0.766666666666667,0.925,0.85,0.816666666666667,0.891666666666667,0.8,0.75,0.933333333333333,0.775,0.783333333333333,0.625,0.758333333333333,0.575,0.891666666666667,0.841666666666667,0.575,0.633333333333333,0.5]



x = np.arange(35)
i = 0
q = [0]
qq = []
for idx, st in enumerate(dsizes):
    q.append(st+i)
    if idx == 0:
        qq.append(0.5*st)
    else:
        qq.append(sum(dsizes[:idx])+(0.5*st))
    i=i+st
y = np.array(q)
yticks = np.array(qq)

X,Y = np.meshgrid(x,y)

Z=np.zeros((len(y),len(x)))

Z[0] = np.array(SWU4)
Z[1] = np.array(HNU1)
Z[2] = np.array(XHCUMS)
Z[3] = np.array(BNU1)
Z[4] = np.array(IPCAS8)
Z[5] = np.array(NKI1)
Z[6] = np.array(NKI24)
Z[7] = np.array(MRN1)

fig, ax = plt.subplots()
plt.pcolormesh(X,Y,Z,cmap='PiYG')
ax.set_xticks(np.arange(0.5,len(func_atlases)+0.5,1))
ax.set_yticks(np.array(yticks))

ax.set_xticklabels(np.array(func_atlases))
ax.set_yticklabels(np.array(func_datasets))

ax.tick_params(top=True, bottom=False, labeltop=True, labelbottom=False)
plt.setp(ax.get_xticklabels(), rotation=-30, ha="right", rotation_mode="anchor")


ax.set_aspect(aspect=0.05)

#plt.colorbar()
plt.savefig('/qwop.png')







##-----------FUNCTIONAL DISCRIM-------------------##

func_datasets=['SWU4','HNU1','NYU2','XHCUMS','UPSM1','BNU3','IPCAS7','SWU1','IPCAS1','BNU1']
dsizes=[429,300,300,247,230,144,144,119,114,106]
func_atlases=['Schaefer1000','Slab907','Schaefer400','Slab1068','CAPRSC','Schaefer300','AICHA','Schaefer200','Glasser','CPAC200','DS00278','DS00195','Princetonvisual','DS00140','Talairach','DS00096','DS00108','DS00071','Destrieux','Juelich','Desikan','MICCAI','AAL','HOC','DKT','Brodmann','DesikanKlein','Hammersmith','Yeo-17','Yeo-17-lib','HOS','JHU','Yeo-7','Yeo-7-lib','Tissue']
tot=sum(dsizes)

SWU4=[0.97539994147198,0.979033556064966,0.965547724723211,0.977021655367507,0.966834121835829,0.958091498805053,0.94844047212603,0.947343071745598,0.953512900551139,0.944215480661366,0.911805589425938,0.920170218992342,0.918737501829001,0.915231917280398,0.924907330634541,0.908769448373409,0.903751889967322,0.897112617665707,0.90472735697215,0.893613129785885,0.883468272935668,0.882017265765986,0.888778471443203,0.886358093937472,0.863288299273277,0.862355508949909,0.844864166219577,0.847504023801395,0.775477978832366,0.772746671218846,0.721632200165829,0.709944886114227,0.694160610642345,0.688024313515095,0.509254743208311]
HNU1=[0.989564495530013,0.992618135376756,0.985633461047254,0.991383141762452,0.983072796934866,0.982403575989783,0.978360153256705,0.977982120051085,0.977301404853129,0.976489144316731,0.984035759897829,0.981282247765006,0.981196679438059,0.975215836526181,0.978586206896552,0.977877394636015,0.976651340996169,0.969558109833972,0.959031928480204,0.959130268199234,0.950634738186462,0.950449553001277,0.947775223499362,0.953628352490422,0.943761174968071,0.937464878671775,0.927902937420179,0.928049808429119,0.864420178799489,0.86987037037037,0.815300127713921,0.81323754789272,0.737537037037037,0.742994891443167,0.576372924648787]
NYU2=[0.980692834412396,0.970672583330068,0.969495722546002,0.957482054685518,0.959664430023048,0.96226132424273,0.952904267258856,0.950823952441123,0.947138085987665,0.947277626350427,0.937433176799557,0.920798148271197,0.898223989919845,0.914670828523097,0.894003547527228,0.904869604339012,0.908818781277378,0.899690928127417,0.903106431233778,0.905637786875285,0.898751847242479,0.899222209114868,0.892742576683951,0.890785407860822,0.885733698762773,0.863079515071728,0.872712703773063,0.865935232684962,0.809218479849415,0.806573608899477,0.773514289455274,0.68437482609815,0.699128091822558,0.694646045032749,0.524540666936404]
XHCUMS=[0.954752138883062,0.941729304290289,0.942230538702514,0.921415758310532,0.917172724281844,0.932247476085502,0.907650194693311,0.915008034239715,0.911657880657409,0.901590233335831,0.899645578542485,0.893647514738429,0.889869421784513,0.897660401914396,0.834521728582697,0.87029536727317,0.854394120727622,0.866746638861999,0.845277992101926,0.852193810709295,0.846030357896135,0.83036601700737,0.850139435292889,0.845049967377971,0.820150117301697,0.835835606497055,0.798989224900143,0.807498686147632,0.751354458101751,0.747003195963197,0.718645718056873,0.711097941863451,0.676208111625702,0.675731118416405,0.503866086917757]
UPSM1=[0.957041557107577,0.944042293945171,0.933608341882958,0.904918045886361,0.912995413107283,0.921016119139592,0.904965081937164,0.901090449417661,0.895170626452397,0.891506717861907,0.839322550111857,0.794656523022482,0.874809464646203,0.805636565450574,0.808832050667694,0.800011731771744,0.791412791045401,0.808123725274595,0.827833646624506,0.79904594907612,0.804700868877535,0.793831666872891,0.773463361882662,0.785884148209204,0.770484169856684,0.762405894603893,0.752126186888456,0.726284871147856,0.712727652669819,0.710120329961831,0.636213497421553,0.608210097265952,0.625243049863541,0.62754942054249,0.511550770725343]
BNU3=[0.989041568163909,0.991996650906226,0.976014578408196,0.988204294720252,0.97763987391647,0.96875,0.958628841607565,0.949271079590228,0.943804176516942,0.949665090622537,0.974881796690308,0.968577620173365,0.917356185973207,0.957865445232466,0.959613869188338,0.931786840031521,0.944715327029157,0.927132584712372,0.890341804570528,0.92400512214342,0.906693262411348,0.897803388494878,0.891449960598897,0.85192572892041,0.883692868400315,0.871503152088259,0.873620961386919,0.877979708431836,0.747192671394799,0.746035263987392,0.784500591016548,0.827940307328605,0.609670508274232,0.613499802994484,0.510786052009456]
IPCAS7=[0.999755477308294,0.997750391236307,0.994816118935837,0.995109546165884,0.997603677621283,0.993984741784038,0.994620500782472,0.98816510172144,0.982492175273865,0.987920579029734,0.99153951486698,0.98523082942097,0.990512519561815,0.976721439749609,0.987187010954616,0.970803990610329,0.973298122065728,0.966158059467919,0.952073552425665,0.945569248826291,0.963321596244132,0.969874804381847,0.97339593114241,0.939700704225352,0.956034820031299,0.938722613458529,0.953247261345853,0.943613067292645,0.816167840375587,0.82096048513302,0.844874804381847,0.771909233176839,0.690409820031299,0.696302816901409,0.523376369327074]
SWU1=[0.985000749962502,0.991480425978701,0.97655617219139,0.985436122930696,0.974937042621553,0.969416529173541,0.962157681589605,0.958497206718612,0.96179717329923,0.968787744823285,0.974216289185541,0.964241787910604,0.934142240256408,0.945903494298969,0.94357518966157,0.946041776858526,0.939869717040464,0.943788731616051,0.921391035711372,0.919804272944248,0.920806985966491,0.925953439170147,0.921076709322429,0.912921985479674,0.91030987924288,0.917657669748091,0.895648243903594,0.904475434123031,0.813373673421592,0.808141040316405,0.816015515013723,0.803349569363637,0.72488737405235,0.71317815688163,0.502484612611475]
IPCAS1=[0.992185924581569,0.990774349667272,0.984398151801292,0.98860657390603,0.986666315964825,0.97847567444348,0.977088210280824,0.966227412609485,0.965519433265823,0.963829269575739,0.970030116520687,0.961637602251506,0.950040330711837,0.935650595754754,0.971138553530252,0.921742418264552,0.932296351824088,0.919467240064178,0.91072818853731,0.917386701386149,0.89777479681212,0.914627993021034,0.907601681615333,0.897049720753658,0.906519328055271,0.87214704051483,0.886400001753509,0.863700167460129,0.802251944203337,0.802182461400878,0.746974429451941,0.765134757182812,0.675811765170046,0.671001341434546,0.4890949262211]
BNU1=[0.990433673469388,0.996811224489796,0.981611394557823,0.989583333333333,0.979272959183674,0.976084183673469,0.973639455782313,0.970769557823129,0.972895408163265,0.973639455782313,0.980973639455782,0.970344387755102,0.956951530612245,0.973107993197279,0.95046768707483,0.959396258503402,0.963329081632653,0.966305272108844,0.956738945578231,0.920280612244898,0.95078656462585,0.944515306122449,0.947172619047619,0.945259353741497,0.948235544217687,0.936224489795918,0.920174319727891,0.919855442176871,0.860012755102041,0.853210034013605,0.750212585034014,0.731505102040816,0.773384353741497,0.771258503401361,0.517431972789116]



x = np.arange(35)
i = 0
q = [0]
qq = []
for idx, st in enumerate(dsizes):
    q.append(st+i)
    if idx == 0:
        qq.append(0.5*st)
    else:
        qq.append(sum(dsizes[:idx])+(0.5*st))
    i=i+st
y = np.array(q)
yticks = np.array(qq)

X,Y = np.meshgrid(x,y)

Z=np.zeros((len(y),len(x)))

Z[0] = np.array(SWU4)
Z[1] = np.array(HNU1)
Z[2] = np.array(NYU2)
Z[3] = np.array(XHCUMS)
Z[4] = np.array(UPSM1)
Z[5] = np.array(BNU3)
Z[6] = np.array(IPCAS7)
Z[7] = np.array(SWU1)
Z[8] = np.array(IPCAS1)
Z[9] = np.array(BNU1)

fig, ax = plt.subplots()
plt.pcolormesh(X,Y,Z,cmap='PiYG')
ax.set_xticks(np.arange(0.5,len(func_atlases)+0.5,1))
ax.set_yticks(np.array(yticks))

ax.set_xticklabels(np.array(func_atlases))
ax.set_yticklabels(np.array(func_datasets))

ax.tick_params(top=True, bottom=False, labeltop=True, labelbottom=False)
plt.setp(ax.get_xticklabels(), rotation=-30, ha="right", rotation_mode="anchor")


ax.set_aspect(aspect=0.05)

#plt.colorbar()
plt.savefig('/qwop.png')

print('stop')


